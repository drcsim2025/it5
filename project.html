<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>HTML ìš©ì–´ ì‚¬ì „ & í€´ì¦ˆ</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <button
      id="menuBtn"
      aria-haspopup="true"
      aria-expanded="false"
      aria-controls="menuBox"
      title="ë©”ë‰´ ì—´ê¸°/ë‹«ê¸°"
    >
      â˜° ë©”ë‰´
    </button>
    <nav id="menuBox" role="menu" aria-hidden="true" tabindex="-1">
      <button id="showTermsBtn" role="menuitem">ìš©ì–´ ì‚¬ì „ ë³´ê¸°</button>
      <button id="showQuizBtn" role="menuitem">í€´ì¦ˆ í’€ê¸°</button>
      <button id="toggleDarkBtn" role="menuitem" aria-pressed="false">
        ë‹¤í¬ëª¨ë“œ í† ê¸€
      </button>
    </nav>

    <form
      id="searchForm"
      autocomplete="off"
      role="search"
      aria-label="ìš©ì–´ ê²€ìƒ‰"
    >
      <div id="searchContainer">
        <input
          type="text"
          id="searchBox"
          aria-autocomplete="list"
          aria-controls="autocompleteList"
          aria-expanded="false"
          aria-haspopup="listbox"
          placeholder="ê²€ìƒ‰ì–´ ì…ë ¥ (ì˜ˆ: span,form,table)"
        />
        <button id="searchBtn" aria-label="ê²€ìƒ‰">ğŸ”</button>
        <ul id="autocompleteList" role="listbox" hidden></ul>
      </div>
    </form>

    <main id="contentArea" tabindex="0" aria-live="polite">
      <!-- ìš©ì–´ ì¹´ë“œ ë˜ëŠ” í€´ì¦ˆ ë‚´ìš© ì¶œë ¥ ì˜ì—­ -->
    </main>

    <script>
      // ìš©ì–´ ë°ì´í„°ì¶”ê°€ + ìš©ì–´ì— exì¶”ê°€ ì˜ˆì‹œëŠ” exì—ë‹¤ê°€ ë„£ìœ¼ì„¸ìš”
      const terms = [
        {
          term: "span",
          desc: "ì¸ë¼ì¸ ìš”ì†Œë¡œ, í…ìŠ¤íŠ¸ ì¼ë¶€ë¥¼ ê°ì‹¸ ìŠ¤íƒ€ì¼ë§í•  ë•Œ ì‚¬ìš©.",
          ex: "<span style='color:red;'>ë¹¨ê°„ í…ìŠ¤íŠ¸</span>",
          ex2: "ì‚¬ìš©ë²•: &lt;span style=&#x27;color:red;&#x27;&gt;ë¹¨ê°„ í…ìŠ¤íŠ¸&lt;/span&gt;",
        },
        {
          term: "a",
          desc: "HTMLì—ì„œ í•˜ì´í¼ë§í¬ë¥¼ ì •ì˜í•˜ëŠ” íƒœê·¸.",
          ex: "<a href='https://naver.com'>ì˜ˆì‹œ ë§í¬</a>",
          ex2: "ì‚¬ìš©ë²•: &lt;a href=&#x27;https://naver.com&#x27;&gt;ì˜ˆì‹œ ë§í¬&lt;/a&gt;",
        },
        {
          term: "img",
          desc: "ì´ë¯¸ì§€ë¥¼ ì‚½ì…í•˜ëŠ” HTML íƒœê·¸.",
          ex: "<img src='image.jpg' alt='ì˜ˆì‹œ ì´ë¯¸ì§€'>",
          ex2: "ì‚¬ìš©ë²•: &lt;img src=&#x27;image.jpg&#x27; alt=&#x27;ì˜ˆì‹œ ì´ë¯¸ì§€&#x27;&gt;",
        },
        {
          term: "ul",
          desc: "ìˆœì„œ ì—†ëŠ” ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“œëŠ” HTML íƒœê·¸.",
          ex: "<ul><li>í•­ëª© 1</li><li>í•­ëª© 2</li></ul>",
          ex2: "ì‚¬ìš©ë²•: &lt;ul&gt;&lt;li&gt;í•­ëª© 1&lt;/li&gt;&lt;li&gt;í•­ëª© 2&lt;/li&gt;&lt;/ul&gt;",
        },
        {
          term: "ol",
          desc: "ìˆœì„œ ìˆëŠ” ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“œëŠ” HTML íƒœê·¸.",
          ex: "<ol><li>ì²« ë²ˆì§¸</li><li>ë‘ ë²ˆì§¸</li></ol>",
          ex2: "ì‚¬ìš©ë²•: &lt;ol&gt;&lt;li&gt;ì²« ë²ˆì§¸&lt;/li&gt;&lt;li&gt;ë‘ ë²ˆì§¸&lt;/li&gt;&lt;/ol&gt;",
        },
        {
          term: "form",
          desc: "ì‚¬ìš©ì ì…ë ¥ì„ ë°›ëŠ” HTML í¼ ìš”ì†Œ.",
          ex: "<form><input type='text'></form>",
          ex2: "ì‚¬ìš©ë²•: &lt;form&gt;&lt;input type=&#x27;text&#x27;&gt;&lt;/form&gt;",
        },
        {
          term: "input",
          desc: "í…ìŠ¤íŠ¸ í•„ë“œ, ì²´í¬ë°•ìŠ¤ ë“±ì˜ ì‚¬ìš©ì ì…ë ¥ í•„ë“œë¥¼ ìƒì„±í•˜ëŠ” HTML íƒœê·¸.",
          ex: "<input type='checkbox'>",
          ex2: "ì‚¬ìš©ë²•: &lt;input type=&#x27;checkbox&#x27;&gt;",
        },
        {
          term: "button",
          desc: "í´ë¦­ ê°€ëŠ¥í•œ ë²„íŠ¼ì„ ìƒì„±í•˜ëŠ” HTML ìš”ì†Œ.",
          ex: "<button>í´ë¦­</button>",
          ex2: "ì‚¬ìš©ë²•: &lt;button&gt;í´ë¦­&lt;/button&gt;",
        },
        {
          term: "table",
          desc: "í‘œ(table)ë¥¼ ë§Œë“œëŠ” HTML íƒœê·¸.",
          ex: "<table><tr><td>ë°ì´í„°</td></tr></table>",
          ex2: "ì‚¬ìš©ë²•: &lt;table&gt;&lt;tr&gt;&lt;td&gt;ë°ì´í„°&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;",
        },
        {
          term: "document.getElementById",
          desc: "JavaScriptë¡œ íŠ¹ì • IDë¥¼ ê°€ì§„ ìš”ì†Œë¥¼ ì„ íƒí•˜ëŠ” ë©”ì„œë“œ.",
          ex: "document.getElementById('myId')",
          ex2: "ì‚¬ìš©ë²•: document.getElementById(&#x27;myId&#x27;)",
        },
        {
          term: "addEventListener",
          desc: "JavaScriptì—ì„œ ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•˜ëŠ” í•¨ìˆ˜.",
          ex: "element.addEventListener('click', callback)",
          ex2: "ì‚¬ìš©ë²•: element.addEventListener(&#x27;click&#x27;, callback)",
        },
        {
          term: "setTimeout",
          desc: "ì¼ì • ì‹œê°„ í›„ì— í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ëŠ” JavaScript í•¨ìˆ˜.",
          ex: "setTimeout(() => { alert('Hi') }, 1000)",
          ex2: "ì‚¬ìš©ë²•: setTimeout(() =&gt; { alert(&#x27;Hi&#x27;) }, 1000)",
        },
        {
          term: "setInterval",
          desc: "ì¼ì • ì‹œê°„ë§ˆë‹¤ í•¨ìˆ˜ë¥¼ ë°˜ë³µ ì‹¤í–‰í•˜ëŠ” JavaScript í•¨ìˆ˜.",
          ex: "setInterval(() => { console.log('ë°˜ë³µ') }, 1000)",
          ex2: "ì‚¬ìš©ë²•: setInterval(() =&gt; { console.log(&#x27;ë°˜ë³µ&#x27;) }, 1000)",
        },
        {
          term: "querySelector",
          desc: "CSS ì„ íƒì ë°©ì‹ìœ¼ë¡œ ìš”ì†Œë¥¼ ì„ íƒí•˜ëŠ” JavaScript ë©”ì„œë“œ.",
          ex: "document.querySelector('.className')",
          ex2: "ì‚¬ìš©ë²•: document.querySelector(&#x27;.className&#x27;)",
        },
        {
          term: "console.log",
          desc: "ì½˜ì†”ì— ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•˜ëŠ” JavaScript ëª…ë ¹ì–´.",
          ex: "console.log('Hello, World!')",
          ex2: "ì‚¬ìš©ë²•: console.log(&#x27;Hello, World!&#x27;)",
        },
        {
          term: "filter",
          desc: "ì¡°ê±´ì— ë§ëŠ” ë°°ì—´ ìš”ì†Œë§Œ ì¶”ì¶œí•˜ëŠ” JavaScript ë©”ì„œë“œ.",
          ex: "[1,2,3,4].filter(x => x > 2)",
          ex2: "ì‚¬ìš©ë²•: [1,2,3,4].filter(ìš”ì†Œ => ì¡°ê±´)",
        },
        {
          term: "reduce",
          desc: "ë°°ì—´ì„ í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ ì¤„ì´ëŠ” JavaScript í•¨ìˆ˜.",
          ex: "[1,2,3,4].reduce((acc, cur) => acc + cur, 0)",
          ex2: "ì‚¬ìš©ë²•: ë°°ì—´.reduce((ëˆ„ì ê°’, í˜„ì¬ê°’) => ì²˜ë¦¬, ì´ˆê¸°ê°’)",
        },
        {
          term: "async/await",
          desc: "ë¹„ë™ê¸° ì½”ë“œë¥¼ ë™ê¸°ì‹ì²˜ëŸ¼ ì‘ì„±í•˜ê²Œ í•´ì£¼ëŠ” JavaScript í‚¤ì›Œë“œ.",
          ex: "async function fetchData() { await fetch(url) }",
          ex2: "ì‚¬ìš©ë²•: async function í•¨ìˆ˜() { await ë¹„ë™ê¸°ì‘ì—… }",
        },
        {
          term: "fetch",
          desc: "JavaScriptì—ì„œ HTTP ìš”ì²­ì„ ë³´ë‚´ëŠ” í•¨ìˆ˜.",
          ex: "fetch('/api').then(res => res.json())",
          ex2: "ì‚¬ìš©ë²•: fetch(url).then(response => ì²˜ë¦¬)",
        },
        {
          term: "try...catch",
          desc: "ì˜¤ë¥˜ ì²˜ë¦¬ë¥¼ ìœ„í•œ JavaScript ë¬¸ë²•.",
          ex: "try { JSON.parse('wrong') } catch (e) { console.error(e) }",
          ex2: "ì‚¬ìš©ë²•: try { ì‹¤í–‰ë¬¸ } catch (ì˜¤ë¥˜) { ì²˜ë¦¬ë¬¸ }",
        },
        {
          term: "typeof",
          desc: "ê°’ì˜ ìë£Œí˜•ì„ í™•ì¸í•˜ëŠ” JavaScript ì—°ì‚°ì.",
          ex: "typeof 'hello'",
          ex2: "ì‚¬ìš©ë²•: typeof ê°’",
        },
        {
          term: "Math.random",
          desc: "0ê³¼ 1 ì‚¬ì´ì˜ ë‚œìˆ˜ë¥¼ ìƒì„±í•˜ëŠ” JavaScript í•¨ìˆ˜.",
          ex: "Math.random()",
          ex2: "ì‚¬ìš©ë²•: Math.random()",
        },
        {
          term: "innerHTML",
          desc: "HTML ìš”ì†Œì˜ ë‚´ë¶€ ì½˜í…ì¸ ë¥¼ ì½ê±°ë‚˜ ë³€ê²½í•˜ëŠ” ì†ì„±.",
          ex: "document.getElementById('app').innerHTML = '<p>Hello</p>'",
          ex2: "ì‚¬ìš©ë²•: ìš”ì†Œ.innerHTML = 'ë³€ê²½í•  ë‚´ìš©'",
        },
        {
          term: "classList.add",
          desc: "ìš”ì†Œì— í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ëŠ” JavaScript ë©”ì„œë“œ.",
          ex: "element.classList.add('active')",
          ex2: "ì‚¬ìš©ë²•: ìš”ì†Œ.classList.add('í´ë˜ìŠ¤ëª…')",
        },
        {
          term: "classList.remove",
          desc: "ìš”ì†Œì—ì„œ í´ë˜ìŠ¤ë¥¼ ì œê±°í•˜ëŠ” JavaScript ë©”ì„œë“œ.",
          ex: "element.classList.remove('hidden')",
          ex2: "ì‚¬ìš©ë²•: ìš”ì†Œ.classList.remove('í´ë˜ìŠ¤ëª…')",
        },
        {
          term: ".next()",
          desc: "ì„ íƒëœ ìš”ì†Œ ë°”ë¡œ ë‹¤ìŒ í˜•ì œ ìš”ì†Œ ë°˜í™˜",
          ex: '$(".item").next()',
          ex2: "ì‚¬ìš©ë²•: $(ì„ íƒì).next()",
        },
        {
          term: ".prev()",
          desc: "ì„ íƒëœ ìš”ì†Œ ë°”ë¡œ ì• í˜•ì œ ìš”ì†Œ ë°˜í™˜",
          ex: '$(".item").prev()',
          ex2: "ì‚¬ìš©ë²•: $(ì„ íƒì).prev()",
        },
        {
          term: ".eq()",
          desc: "ì„ íƒëœ ìš”ì†Œ ì¤‘ ì§€ì •ëœ ì¸ë±ìŠ¤ì˜ ìš”ì†Œ ë°˜í™˜",
          ex: '$("li").eq(2)',
          ex2: "ì‚¬ìš©ë²•: $(ì„ íƒì).eq(ì¸ë±ìŠ¤)",
        },
        {
          term: ".first()",
          desc: "ì„ íƒëœ ìš”ì†Œ ì¤‘ ì²« ë²ˆì§¸ ìš”ì†Œ ë°˜í™˜",
          ex: '$("div").first()',
          ex2: "ì‚¬ìš©ë²•: $(ì„ íƒì).first()",
        },
        {
          term: ".last()",
          desc: "ì„ íƒëœ ìš”ì†Œ ì¤‘ ë§ˆì§€ë§‰ ìš”ì†Œ ë°˜í™˜",
          ex: '$("div").last()',
          ex2: "ì‚¬ìš©ë²•: $(ì„ íƒì).last()",
        },
        {
          term: ".filter()",
          desc: "ì„ íƒëœ ìš”ì†Œ ì¤‘ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ìš”ì†Œë§Œ ë°˜í™˜",
          ex: '$("li").filter(".active")',
          ex2: "ì‚¬ìš©ë²•: $(ì„ íƒì).filter(ì¡°ê±´)",
        },
        {
          term: ".not()",
          desc: "ì„ íƒëœ ìš”ì†Œ ì¤‘ ì¡°ê±´ì— ë§ì§€ ì•ŠëŠ” ìš”ì†Œë§Œ ë°˜í™˜",
          ex: '$("li").not(".active")',
          ex2: "ì‚¬ìš©ë²•: $(ì„ íƒì).not(ì¡°ê±´)",
        },
        {
          term: ".has()",
          desc: "íŠ¹ì • ìì‹ ìš”ì†Œë¥¼ í¬í•¨í•˜ëŠ” ìš”ì†Œë§Œ ì„ íƒ",
          ex: '$("div").has("p")',
          ex2: "ì‚¬ìš©ë²•: $(ì„ íƒì).has(ìì‹ì„ íƒì)",
        },
        {
          term: ".is()",
          desc: "ì„ íƒëœ ìš”ì†Œê°€ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ”ì§€ ì—¬ë¶€ ë°˜í™˜",
          ex: '$("input").is(":checked")',
          ex2: "ì‚¬ìš©ë²•: $(ì„ íƒì).is(ì¡°ê±´)",
        },
        {
          term: ".add()",
          desc: "í˜„ì¬ ì„ íƒëœ ìš”ì†Œ ì§‘í•©ì— ë‹¤ë¥¸ ìš”ì†Œë¥¼ ì¶”ê°€",
          ex: '$("p").add(".highlight")',
          ex2: "ì‚¬ìš©ë²•: $(ì„ íƒì).add(ì¶”ê°€í•  ìš”ì†Œ)",
        },
        {
          term: ".end()",
          desc: "ì²´ì´ë‹ ì¤‘ ì¶•ì†Œëœ ì§‘í•©ì—ì„œ ì´ì „ jQuery ê°ì²´ë¡œ ë³µê·€",
          ex: '$("div").find("p").end()',
          ex2: "ì‚¬ìš©ë²•: ì²´ì´ë‹ëœ jQuery ê°ì²´ì—ì„œ .end() í˜¸ì¶œ",
        },
      ];
      // í€´ì¦ˆ ë°ì´í„° (ê°™ì€ ìš©ì–´ë“¤ë¡œ ë¬¸ì œ+ë³´ê¸° êµ¬ì„±)
      // ê° ë¬¸ì œëŠ” ì •ë‹µì¸ ì¸ë±ìŠ¤ë¥¼ ë§ê²Œ ì„ì–´ì„œ ì„¤ì •
      let quizData = [];

      function shuffleArray(arr) {
        for (let i = arr.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [arr[i], arr[j]] = [arr[j], arr[i]];
        }
      }

      // í€´ì¦ˆ ìƒì„±: termsì¤‘ ëœë¤ 5ë¬¸ì œë¥¼ ë½‘ì•„ ë³´ê¸° 4ê°œì”© ì„ì–´ì„œ ë§Œë“¦
      function generateQuizData() {
        quizData = [];
        const shuffledTerms = [...terms];
        shuffleArray(shuffledTerms);
        const pickCount = Math.min(5, shuffledTerms.length);
        for (let i = 0; i < pickCount; i++) {
          const question = shuffledTerms[i].term;
          const answer = shuffledTerms[i].desc;

          // ë³´ê¸° 3ê°œ ëœë¤ìœ¼ë¡œ ì¶”ì¶œ (ì •ë‹µ ì œì™¸)
          let options = [answer];
          const others = terms.filter((t) => t.term !== question);
          shuffleArray(others);
          for (let j = 0; j < 3; j++) {
            options.push(others[j].desc);
          }
          shuffleArray(options);

          const answerIndex = options.indexOf(answer);

          quizData.push({
            question,
            options,
            answer: answerIndex,
          });
        }
      }

      // UI ìš”ì†Œ ì°¸ì¡°
      const menuBtn = document.getElementById("menuBtn");
      const menuBox = document.getElementById("menuBox");
      const showTermsBtn = document.getElementById("showTermsBtn");
      const showQuizBtn = document.getElementById("showQuizBtn");
      const toggleDarkBtn = document.getElementById("toggleDarkBtn");
      const contentArea = document.getElementById("contentArea");
      const searchBox = document.getElementById("searchBox");
      const searchBtn = document.getElementById("searchBtn");
      const autocompleteList = document.getElementById("autocompleteList");
      const searchForm = document.getElementById("searchForm");

      // ë©”ë‰´ ì—´ê¸°/ë‹«ê¸°
      function toggleMenu() {
        const isOpen = menuBox.classList.toggle("open");
        menuBtn.setAttribute("aria-expanded", isOpen);
        menuBox.setAttribute("aria-hidden", !isOpen);
        if (isOpen) {
          menuBox.focus();
        }
      }
      menuBtn.addEventListener("click", toggleMenu);

      // ë©”ë‰´ í•­ëª© í´ë¦­ ì‹œ ë©”ë‰´ ë‹«ê¸°
      function closeMenu() {
        menuBox.classList.remove("open");
        menuBtn.setAttribute("aria-expanded", false);
        menuBox.setAttribute("aria-hidden", true);
        menuBtn.focus();
      }

      // // ìš©ì–´ ì¹´ë“œ ìƒˆ ì°½ ì—´ê¸° <ì½”ë“œì‚­ì œì˜ˆì •> í˜„ì¬í˜ì´ì§€ì—ì„œ ì‹¤í–‰ë˜ë„ë¡ ë³€ê²½í• ê²ƒ ì£¼ì„ì²˜ë¦¬í•¨!
      // function openTermInNewWindow(term) {
      //   const url = `term.html?term=${encodeURIComponent(term)}`;
      //   window.open(
      //     url,
      //     "_blank",
      //     "width=480,height=400,scrollbars=yes,resizable=yes"
      //   );
      // }

      function showTermDetail(term, pushState = true) {
        const found = terms.find((t) => t.term === term);
        if (!found) {
          contentArea.innerHTML = `<p>ìš©ì–´ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>`;
          return;
        }

        if (pushState) {
          history.pushState(
            { view: "detail", term },
            "",
            `#term=${encodeURIComponent(term)}`
          );
        }
        //ì¹´ë“œ ëˆŒë €ì„ë•Œ ìƒì„¸ë³´ê¸°ì„¹ì…˜ ì£¼ì„
        contentArea.innerHTML = `
        <section class="term-detail fade-in" tabindex="0">
          <h2>${found.term}</h2>
          <p>${found.desc}</p>
          <form id="fo1">
            <p>${found.ex}</p>
            </form><br>
          <form id="fo2">
            <p>${found.ex2}</p>
            </form>
          <button id="backToListBtn">ëª©ë¡ìœ¼ë¡œ</button>
        </section>
      `;

        const backBtn = document.getElementById("backToListBtn");
        backBtn.addEventListener("click", () => {
          history.pushState({ view: "list" }, "", "#list");
          showTerms();
        });

        contentArea.querySelector(".term-detail").focus();
      }

      // ìš©ì–´ ì¹´ë“œ ë³´ì—¬ì£¼ê¸° (í•„í„°ë§ ê°€ëŠ¥)
      function showTerms(filter = "") {
        contentArea.innerHTML = "";
        let filteredTerms = terms;
        if (filter.trim() !== "") {
          const lowerFilter = filter.trim().toLowerCase();
          filteredTerms = terms.filter(
            (t) =>
              t.term.toLowerCase().includes(lowerFilter) ||
              t.desc.toLowerCase().includes(lowerFilter)
          );
        }
        if (filteredTerms.length === 0) {
          contentArea.innerHTML = `<p>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>`;
          return;
        }
        filteredTerms.forEach(({ term, desc }) => {
          const card = document.createElement("article");
          card.className = "term-card";
          card.tabIndex = 0;
          card.setAttribute("role", "button");
          card.setAttribute("aria-label", `${term} ìš©ì–´ ì„¤ëª… ë³´ê¸°`);
          card.innerHTML = `<h3>${term}</h3><p>${
            desc.length > 100 ? desc.slice(0, 100) + "..." : desc // ì¹´ë“œë‚´ìš©ìƒì„¸ <<ê²€ìƒ‰ìš©í‚¤ì›Œë“œ ì£¼ì„ì§€ìš°ì§€ë§ê¸°
          }</p>`;
          // card.addEventListener("click", () => openTermInNewWindow(term));
          // card.addEventListener("keydown", (e) => {
          //   if (e.key === "Enter" || e.key === " ") {
          //     e.preventDefault();
          //     openTermInNewWindow(term);
          //   }

          card.addEventListener("click", () => showTermDetail(term));
          card.addEventListener("keydown", (e) => {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              showTermDetail(term);
            }
          });
          contentArea.appendChild(card);
        });
      }

      // ìë™ì™„ì„± ë¦¬ìŠ¤íŠ¸ ë³´ì—¬ì£¼ê¸°
      function updateAutocomplete() {
        const val = searchBox.value.trim().toLowerCase();
        if (val.length === 0) {
          autocompleteList.innerHTML = "";
          autocompleteList.hidden = true;
          searchBox.setAttribute("aria-expanded", "false");
          return;
        }
        const matched = terms
          .filter(
            (t) =>
              t.term.toLowerCase().includes(val) ||
              t.desc.toLowerCase().includes(val)
          )
          .slice(0, 10);

        if (matched.length === 0) {
          autocompleteList.innerHTML = "";
          autocompleteList.hidden = true;
          searchBox.setAttribute("aria-expanded", "false");
          return;
        }
        autocompleteList.innerHTML = matched
          .map(
            (t) =>
              `<li role="option" tabindex="0" data-term="${t.term}">${t.term}</li>`
          )
          .join("");
        autocompleteList.hidden = false;
        searchBox.setAttribute("aria-expanded", "true");
      }

      // ìë™ì™„ì„± í•­ëª© í´ë¦­ ì‹œ ê²€ìƒ‰ ì‹¤í–‰
      autocompleteList.addEventListener("click", (e) => {
        if (e.target.tagName === "LI") {
          const term = e.target.dataset.term;
          searchBox.value = term;
          autocompleteList.innerHTML = "";
          autocompleteList.hidden = true;
          searchBox.setAttribute("aria-expanded", "false");
          searchTerm(term);
        }
      });

      // ìë™ì™„ì„± í•­ëª© í‚¤ë³´ë“œ ë‚´ë¹„ê²Œì´ì…˜ & ì„ íƒ
      autocompleteList.addEventListener("keydown", (e) => {
        if (e.key === "ArrowDown" || e.key === "ArrowUp") {
          e.preventDefault();
          const items = [...autocompleteList.querySelectorAll("li")];
          if (items.length === 0) return;
          let idx = items.findIndex((item) =>
            item.classList.contains("active")
          );
          if (idx === -1) idx = 0;
          else items[idx].classList.remove("active");
          if (e.key === "ArrowDown") {
            idx = (idx + 1) % items.length;
          } else {
            idx = (idx - 1 + items.length) % items.length;
          }
          items.forEach((item) => item.classList.remove("active"));
          items[idx].classList.add("active");
          items[idx].focus();
        } else if (e.key === "Enter") {
          e.preventDefault();
          const active = autocompleteList.querySelector("li.active");
          if (active) {
            const term = active.dataset.term;
            searchBox.value = term;
            autocompleteList.innerHTML = "";
            autocompleteList.hidden = true;
            searchBox.setAttribute("aria-expanded", "false");
            searchTerm(term);
          }
        }
      });

      // ê²€ìƒ‰ ì‹¤í–‰ í•¨ìˆ˜
      function searchTerm(term) {
        // ë©”ë‰´ ë‹«ê¸°
        closeMenu();

        // í•„í„°ë§ëœ ìš©ì–´ ë³´ì—¬ì£¼ê¸°
        showTerms(term);
      }

      // ê²€ìƒ‰ì°½ ì…ë ¥ ì´ë²¤íŠ¸
      searchBox.addEventListener("input", updateAutocomplete);

      // í¼ ì œì¶œ (ê²€ìƒ‰) ì²˜ë¦¬
      searchForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const val = searchBox.value.trim();
        if (val !== "") {
          autocompleteList.innerHTML = "";
          autocompleteList.hidden = true;
          searchBox.setAttribute("aria-expanded", "false");
          searchTerm(val);
        }
      });

      // ë©”ë‰´ ë²„íŠ¼ë“¤ í´ë¦­ ì´ë²¤íŠ¸
      showTermsBtn.addEventListener("click", () => {
        closeMenu();
        searchBox.value = "";
        autocompleteList.innerHTML = "";
        autocompleteList.hidden = true;
        searchBox.setAttribute("aria-expanded", "false");
        showTerms();
      });

      showQuizBtn.addEventListener("click", () => {
        closeMenu();
        generateQuizData();
        showQuiz();
      });

      toggleDarkBtn.addEventListener("click", () => {
        const isDark = document.body.classList.toggle("dark-mode");
        toggleDarkBtn.setAttribute("aria-pressed", isDark);
      });

      // í€´ì¦ˆ ê´€ë ¨ ì½”ë“œ
      let currentQuizIndex = 0;
      let score = 0;

      function showQuiz() {
        if (quizData.length === 0) {
          contentArea.innerHTML = "<p>í€´ì¦ˆ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>";
          return;
        }
        score = 0;
        currentQuizIndex = 0;
        renderQuizQuestion();
      }

      function renderQuizQuestion() {
        contentArea.innerHTML = "";
        const quizBox = document.createElement("section");
        quizBox.id = "quizBox";
        quizBox.setAttribute("aria-live", "polite");
        const current = quizData[currentQuizIndex];

        // ë¬¸ì œ í‘œì‹œ
        const questionP = document.createElement("p");
        questionP.id = "question";
        questionP.textContent = `${currentQuizIndex + 1}. ë‹¤ìŒ ì¤‘ "${
          current.question
        }"ì˜ ì„¤ëª…ìœ¼ë¡œ ê°€ì¥ ì ì ˆí•œ ê²ƒì€?`;
        quizBox.appendChild(questionP);

        // ì„ íƒì§€ ë²„íŠ¼ë“¤
        const optionsDiv = document.createElement("div");
        optionsDiv.id = "options";
        current.options.forEach((optionText, idx) => {
          const btn = document.createElement("button");
          btn.textContent = optionText;
          btn.type = "button";
          btn.setAttribute("data-index", idx);
          btn.addEventListener("click", () => {
            handleAnswer(idx);
          });
          optionsDiv.appendChild(btn);
        });
        quizBox.appendChild(optionsDiv);

        // ê²°ê³¼ í‘œì‹œ
        const resultDiv = document.createElement("div");
        resultDiv.id = "result";
        quizBox.appendChild(resultDiv);

        // ë‹¤ìŒ ë²„íŠ¼
        const nextBtn = document.createElement("button");
        nextBtn.id = "nextBtn";
        nextBtn.textContent = "ë‹¤ìŒ ë¬¸ì œ";
        nextBtn.disabled = true;
        nextBtn.addEventListener("click", () => {
          currentQuizIndex++;
          if (currentQuizIndex < quizData.length) {
            renderQuizQuestion();
          } else {
            showQuizResult();
          }
        });
        quizBox.appendChild(nextBtn);

        contentArea.appendChild(quizBox);
      }

      function handleAnswer(selectedIndex) {
        const quizBox = document.getElementById("quizBox");
        const resultDiv = quizBox.querySelector("#result");
        const nextBtn = quizBox.querySelector("#nextBtn");
        const current = quizData[currentQuizIndex];

        // ì •ë‹µ í™•ì¸ ë° í‘œì‹œ
        if (selectedIndex === current.answer) {
          resultDiv.textContent = "ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰";
          resultDiv.style.color = "green";
          score++;
        } else {
          resultDiv.textContent = `ì˜¤ë‹µì…ë‹ˆë‹¤. ì •ë‹µ: "${
            current.options[current.answer]
          }"`;
          resultDiv.style.color = "red";
        }

        // ë²„íŠ¼ ë¹„í™œì„±í™” ë° ë‹¤ìŒ ë²„íŠ¼ í™œì„±í™”
        const optionButtons = quizBox.querySelectorAll("#options button");
        optionButtons.forEach((btn) => {
          btn.disabled = true;
          if (Number(btn.dataset.index) === current.answer) {
            btn.style.borderColor = "green";
            btn.style.backgroundColor = "#d4f8d4";
            btn.style.color = "green";
          }
          if (
            Number(btn.dataset.index) === selectedIndex &&
            selectedIndex !== current.answer
          ) {
            btn.style.borderColor = "red";
            btn.style.backgroundColor = "#f8d4d4";
            btn.style.color = "red";
          }
        });

        nextBtn.disabled = false;
      }

      function showQuizResult() {
        contentArea.innerHTML = "";
        const resultBox = document.createElement("section");
        resultBox.id = "quizBox";

        const scoreP = document.createElement("p");
        scoreP.textContent = `í€´ì¦ˆ ì¢…ë£Œ! ì´ ${quizData.length}ë¬¸ì œ ì¤‘ ${score}ë¬¸ì œ ë§ì¶”ì…¨ìŠµë‹ˆë‹¤.`;
        scoreP.style.fontWeight = "700";
        scoreP.style.fontSize = "1.3rem";
        scoreP.style.marginBottom = "20px";
        resultBox.appendChild(scoreP);

        const retryBtn = document.createElement("button");
        retryBtn.id = "retryBtn";
        retryBtn.textContent = "ë‹¤ì‹œ í’€ê¸°";
        retryBtn.addEventListener("click", () => {
          generateQuizData();
          showQuiz();
        });
        resultBox.appendChild(retryBtn);

        contentArea.appendChild(resultBox);
      }

      // ì´ˆê¸° ì‹¤í–‰
      const hash = window.location.hash;
      if (hash.startsWith("#term=")) {
        const term = decodeURIComponent(hash.split("=")[1]);
        showTermDetail(term, false);
      } else {
        showTerms();
      }
      window.addEventListener("popstate", (e) => {
        if (e.state && e.state.view === "detail") {
          showTermDetail(e.state.term, false);
        } else {
          showTerms();
        }
      });
    </script>
  </body>
</html>
